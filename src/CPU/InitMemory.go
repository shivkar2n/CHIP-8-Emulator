package CPU

import (
	"os"

	"github.com/shivkar2n/Chip8-Emulator/helpers"
)

func (s *State) LoadFonts() { // Load fonts into memory
	fontsBuffer := [16][]byte{
		{0xf0, 0x90, 0x90, 0x90, 0xf0}, // 0
		{0x20, 0x60, 0x20, 0x20, 0x70}, // 1
		{0xf0, 0x10, 0xf0, 0x80, 0xf0}, // 2
		{0xf0, 0x10, 0xf0, 0x10, 0xf0}, // 3
		{0x90, 0x90, 0xf0, 0x10, 0x10}, // 4
		{0xf0, 0x80, 0xf0, 0x10, 0xf0}, // 5
		{0xf0, 0x80, 0xf0, 0x90, 0xf0}, // 6
		{0xf0, 0x10, 0x20, 0x40, 0x40}, // 7
		{0xf0, 0x90, 0xf0, 0x90, 0xf0}, // 8
		{0xf0, 0x90, 0xf0, 0x10, 0xf0}, // 9
		{0xf0, 0x90, 0xf0, 0x90, 0x90}, // A
		{0xe0, 0x90, 0xe0, 0x90, 0xe0}, // B
		{0xf0, 0x80, 0x80, 0x80, 0xf0}, // C
		{0xe0, 0x90, 0x90, 0x90, 0xe0}, // D
		{0xf0, 0x80, 0xf0, 0x80, 0xf0}, // E
		{0xf0, 0x80, 0xf0, 0x80, 0x80}, // F
	}
	for i, font := range fontsBuffer {
		s.WriteMemory(font, 80+5*i)
	}
}

func (s *State) LoadROM() { // Load ROM file into memory
	fileName := os.Args[1]
	f, err := os.Open(fileName)
	n, _ := helpers.GetFileSize(fileName)
	buffer := make([]byte, n)
	_, _ = f.Read(buffer)
	helpers.Check(err)
	s.WriteMemory(buffer, 512)
}
